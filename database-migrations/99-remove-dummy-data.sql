-- ============================================
-- Remove Dummy Data from Database
-- ============================================
-- This migration removes all dummy/test data from the database
-- Run this in Supabase SQL Editor when ready to use only real data
-- ============================================

-- ============================================
-- 1. DELETE DUMMY REVIEWS
-- ============================================
-- Remove all reviews from dummy users
DELETE FROM reviews 
WHERE user_id IN (
  '11111111-1111-1111-1111-111111111111',  -- Daniel (old dummy)
  '22222222-2222-2222-2222-222222222222',  -- Rotem
  '33333333-3333-3333-3333-333333333333',  -- Nir
  '44444444-4444-4444-4444-444444444444',  -- Amit (old dummy)
  '55555555-5555-5555-5555-555555555555',  -- Aviv
  '66666666-6666-6666-6666-666666666666'   -- Yair
);

-- ============================================
-- 2. DELETE DUMMY RESTAURANTS
-- ============================================
-- Remove dummy restaurants (those with IDs starting with 10000000)
DELETE FROM restaurants 
WHERE id::text LIKE '10000000%';

-- ============================================
-- 3. DELETE DUMMY FOLLOW RELATIONSHIPS
-- ============================================
-- Remove follows involving dummy users
DELETE FROM follows 
WHERE follower_id IN (
  '11111111-1111-1111-1111-111111111111',
  '22222222-2222-2222-2222-222222222222',
  '33333333-3333-3333-3333-333333333333',
  '44444444-4444-4444-4444-444444444444',
  '55555555-5555-5555-5555-555555555555',
  '66666666-6666-6666-6666-666666666666'
)
OR following_id IN (
  '11111111-1111-1111-1111-111111111111',
  '22222222-2222-2222-2222-222222222222',
  '33333333-3333-3333-3333-333333333333',
  '44444444-4444-4444-4444-444444444444',
  '55555555-5555-5555-5555-555555555555',
  '66666666-6666-6666-6666-666666666666'
);

-- ============================================
-- 4. DELETE DUMMY WISHLIST ENTRIES
-- ============================================
-- Remove wishlist entries involving dummy users or dummy restaurants
DELETE FROM wishlist 
WHERE user_id IN (
  '11111111-1111-1111-1111-111111111111',
  '22222222-2222-2222-2222-222222222222',
  '33333333-3333-3333-3333-333333333333',
  '44444444-4444-4444-4444-444444444444',
  '55555555-5555-5555-5555-555555555555',
  '66666666-6666-6666-6666-666666666666'
)
OR restaurant_id::text LIKE '10000000%';

-- ============================================
-- 5. DELETE DUMMY REVIEW LIKES
-- ============================================
-- Remove likes from dummy users
DELETE FROM review_likes 
WHERE user_id IN (
  '11111111-1111-1111-1111-111111111111',
  '22222222-2222-2222-2222-222222222222',
  '33333333-3333-3333-3333-333333333333',
  '44444444-4444-4444-4444-444444444444',
  '55555555-5555-5555-5555-555555555555',
  '66666666-6666-6666-6666-666666666666'
);

-- ============================================
-- 6. DELETE DUMMY NOTIFICATIONS
-- ============================================
-- Remove notifications involving dummy users
DELETE FROM notifications 
WHERE user_id IN (
  '11111111-1111-1111-1111-111111111111',
  '22222222-2222-2222-2222-222222222222',
  '33333333-3333-3333-3333-333333333333',
  '44444444-4444-4444-4444-444444444444',
  '55555555-5555-5555-5555-555555555555',
  '66666666-6666-6666-6666-666666666666'
)
OR actor_id IN (
  '11111111-1111-1111-1111-111111111111',
  '22222222-2222-2222-2222-222222222222',
  '33333333-3333-3333-3333-333333333333',
  '44444444-4444-4444-4444-444444444444',
  '55555555-5555-5555-5555-555555555555',
  '66666666-6666-6666-6666-666666666666'
);

-- ============================================
-- 7. DELETE DUMMY PROFILES
-- ============================================
-- Remove dummy user profiles
DELETE FROM profiles 
WHERE id IN (
  '11111111-1111-1111-1111-111111111111',
  '22222222-2222-2222-2222-222222222222',
  '33333333-3333-3333-3333-333333333333',
  '44444444-4444-4444-4444-444444444444',
  '55555555-5555-5555-5555-555555555555',
  '66666666-6666-6666-6666-666666666666'
);

-- ============================================
-- 8. DELETE DUMMY AUTH USERS
-- ============================================
-- Remove dummy users from auth.users
-- NOTE: This requires superuser privileges
-- If you get an error, you'll need to do this manually in Supabase Dashboard
DELETE FROM auth.users 
WHERE id IN (
  '11111111-1111-1111-1111-111111111111',
  '22222222-2222-2222-2222-222222222222',
  '33333333-3333-3333-3333-333333333333',
  '44444444-4444-4444-4444-444444444444',
  '55555555-5555-5555-5555-555555555555',
  '66666666-6666-6666-6666-666666666666'
);

-- ============================================
-- VERIFICATION QUERIES
-- ============================================
-- Run these to verify all dummy data has been removed

-- Check for remaining dummy users
SELECT 'Remaining dummy users' AS check_type, COUNT(*) AS count 
FROM profiles 
WHERE id IN (
  '11111111-1111-1111-1111-111111111111',
  '22222222-2222-2222-2222-222222222222',
  '33333333-3333-3333-3333-333333333333',
  '44444444-4444-4444-4444-444444444444',
  '55555555-5555-5555-5555-555555555555',
  '66666666-6666-6666-6666-666666666666'
);

-- Check for remaining dummy restaurants
SELECT 'Remaining dummy restaurants' AS check_type, COUNT(*) AS count 
FROM restaurants 
WHERE id::text LIKE '10000000%';

-- Check for remaining dummy reviews
SELECT 'Remaining dummy reviews' AS check_type, COUNT(*) AS count 
FROM reviews 
WHERE user_id IN (
  '11111111-1111-1111-1111-111111111111',
  '22222222-2222-2222-2222-222222222222',
  '33333333-3333-3333-3333-333333333333',
  '44444444-4444-4444-4444-444444444444',
  '55555555-5555-5555-5555-555555555555',
  '66666666-6666-6666-6666-666666666666'
);

-- Check for remaining dummy follows
SELECT 'Remaining dummy follows' AS check_type, COUNT(*) AS count 
FROM follows 
WHERE follower_id IN (
  '11111111-1111-1111-1111-111111111111',
  '22222222-2222-2222-2222-222222222222',
  '33333333-3333-3333-3333-333333333333',
  '44444444-4444-4444-4444-444444444444',
  '55555555-5555-5555-5555-555555555555',
  '66666666-6666-6666-6666-666666666666'
)
OR following_id IN (
  '11111111-1111-1111-1111-111111111111',
  '22222222-2222-2222-2222-222222222222',
  '33333333-3333-3333-3333-333333333333',
  '44444444-4444-4444-4444-444444444444',
  '55555555-5555-5555-5555-555555555555',
  '66666666-6666-6666-6666-666666666666'
);

-- ============================================
-- âœ… DONE! 
-- ============================================
-- All dummy data has been removed.
-- Your app is now ready to work with real data only.
--
-- Note: If any real users were following dummy users,
-- those follow relationships have been removed.
-- ============================================

